\documentclass{ximera}

\input{../preamble.tex}

\outcome{View the chain rule in terms of the gradient.}

<<<<<<< HEAD
\outcome{Compute the derivative of the compostion of a function of
  several variables with a vector-valued function.}
=======
\outcome{Evaluate limits of functions of several variables.}
\outcome{Determine continuity of functions of several variables.}
\outcome{Use different paths to show that a limit does not exist.}
>>>>>>> upstream/master

\outcome{Use the chain rule of several variables to implicitly differentiate a curve.}


\title[Dig-In:]{The chain rule}

\begin{document}
\begin{abstract}
  We investigate the chain rule for functions of several variables.
\end{abstract}
\maketitle

The chain rule states that
\[
\ddx\Big(f\big(g(x)\big)\Big) = f'\big(g(x)\big)g'(x).
\]
<<<<<<< HEAD
If $t=g(x)$, we can express the chain rule as
\[
\dd[f]{x} = \dd[f]{t}\dd[t]{x}.
\]
In this section we extend the chain rule to functions of more than one
variable.
=======
to be ``continuous.'' We begin with a series of definitions. We are
used to ``open intervals'' such as $(1,3)$, which represents the set
of all $x$ such that $1<x<3$, and ``closed intervals'' such as
$[1,3]$, which represents the set of all $x$ such that $1\leq x\leq
3$. We need analogous definitions for open and closed sets in $\R^n$.

\begin{definition}
  We give these definitions in general, for when one is working in
  $\R^n$:
  \begin{itemize}
  \item An \dfn{open ball} $B$ in $\R^n$ centered at $\vec{a} =
    \vector{a_1,a_2,\dots,a_n}$ with radius $r$ is the set of all
    vectors $\vec{x}=\vector{x_1,x_2,\dots,x_n}$ such that
    $|\vec{x}-\vec{a}| < r$. In $\R^2$ an open ball is often called an
    \dfn{open disk}.
    \begin{image}
      \begin{tikzpicture}
        \draw[ultra thick,dashed,penColor,fill=fill1] (0,0) circle (2cm);
        \draw[draw=none,fill=black] (0,0) circle (.1cm);
        \draw[dashed] (0,0)--(2,0);
        \node[above] at (1,0) {$|\vec{x}-\vec{a}|$};
        \node[below left] at (0,0) {$\vec{a}$};
      \end{tikzpicture}
    \end{image}
    
  \item A point $\vec{p}$ (denoted by a vector) in $S$ is an
    \dfn{interior point} of $S$ if there is an open ball $B$ centered
    at $\vec{p}$ that contains only points in $S$. We can write this
    in symbols as
    \[
    \vec{p}\in B\subseteq S
    \]
    \begin{image}
      \begin{tikzpicture}
        \draw[ultra thick, penColor,fill=fill1] plot [smooth cycle] coordinates {(-1.5,.5) (.5,1) (1,2.5) (-1,2.5) (-2,1.5)};
        \draw[draw=none,fill=black] (-1,1) circle (.1cm);
        \draw[dashed] (-1,1) circle (.3cm);
        \node[penColor] at (-.5,2) {$S$};      
    \end{tikzpicture}
  \end{image}

  \item Let $S$ be a set of points in $\R^n$. A point $\vec{p}$ (denoted by a vector) in $\R^n$ is
    a \dfn{boundary point} of $S$ if all open balls centered at $\vec{p}$
    contain both points in $S$ and points not in $S$.
    \begin{image}
      \begin{tikzpicture}
        \draw[ultra thick, penColor,fill=fill1] plot [smooth cycle] coordinates {(-1.5,.5) (.5,1) (1,2.5) (-1,2.5) (-2,1.5)};
        \draw[draw=none,fill=black] (.89,1.6) circle (.1cm);
        \draw[dashed] (.89,1.6) circle (.3cm);
        \node[penColor] at (-.5,2) {$S$};      
    \end{tikzpicture}
  \end{image}
  \item A set $O$ is \dfn{open} if every point in $O$ is an interior
    point.
    \begin{image}
      \begin{tikzpicture}
        \draw[ultra thick, dashed, penColor,fill=fill1] plot [smooth cycle] coordinates {(-1.5,.5) (.5,1) (1,2.5) (-1,2.5) (-2,1.5)};
        \node[penColor] at (-.5,2) {$O$};     
      \end{tikzpicture}
    \end{image}
  \item A set $C$ is \dfn{closed} if it contains all of its boundary
    points.
    \begin{image}
      \begin{tikzpicture}
        \draw[ultra thick, penColor,fill=fill1] plot [smooth cycle] coordinates {(-1.5,.5) (.5,1) (1,2.5) (-1,2.5) (-2,1.5)};
        \node[penColor] at (-.5,2) {$C$};     
      \end{tikzpicture}
    \end{image}
  \item A set $S$ is \dfn{bounded} if there is an open ball $B$
    centered at the origin of radius $M$ such that
    \[
    S\subseteq B.
    \]
    A set that is not bounded is \dfn{unbounded}.
  \end{itemize}
  \item Given a set $S$, we denote the \dfn{boundary} of $S$ by
    $\partial S$.
\end{definition}


\begin{example}
  Consider a closed disk $D$ in $\R^2$. Describe $\partial D$ and $\partial \partial D$.
  \begin{explanation}
    Since $\partial D$ is the boundary of a closed disk in $\R^2$, $\partial D$ is \wordChoice{
      \choice{a disk}
      \choice[correct]{a circle}
      \choice{a ball}
      \choice{a line}}. Since $\partial\partial D$ is the boundary of the boundary, and a circle has no boundary, $\partial\partial D$ is \wordChoice{
      \choice[correct]{empty}
      \choice{a line}
      \choice{a circle}
      }.
  \end{explanation}
\end{example}



\begin{example}
  Determine if the domain of the function
  $F(x,y)=\sqrt{1-\frac{x^2}9-\frac{y^2}4}$ is open, closed, or
  neither, and if it is bounded.
  \begin{explanation}
    We've already found the domain of this function to be
    \[
    D = \{(x,y): \answer[given]{x^2/9+y^2/4}\leq 1\}.
    \]
    This is the region \textit{bounded} by the ellipse
    $\frac{x^2}9+\frac{y^2}4=1$. Since the region includes the
    boundary (indicated by the use of ``$\leq$''), the set
    \wordChoice{\choice[correct]{contains}\choice{does not contain}}
    all of its boundary points and hence is closed. The region is
    \wordChoice{\choice[correct]{bounded}\choice{unbounded}} as a disk
    of radius $4$, centered at the origin, contains $D$.
  \end{explanation}
\end{example}

\begin{example}
  Determine if the domain of $F(x,y) = \frac{1}{x-y}$ is open, closed,
  or neither, and if it is bounded.
  \begin{explanation}
    As we cannot divide by $0$, we find the domain to be
    \[
    D = \{(x,y):x-y\neq \answer[given]{0}\}.
    \]
    In other words, the domain is the set of all points $(x,y)$
    \textit{not} on the line $y=x$. For your viewing pleasure, we have
    included a graph:
    \begin{image}
      \begin{tikzpicture}
        \begin{axis}[
            tick label style={font=\scriptsize},axis y line=middle,axis x line=middle,name=myplot,axis on top,%
            xtick=\empty,
            ytick=\empty,
            ymin=-1,ymax=1,%
            xmin=-1,xmax=1%
          ]
          \filldraw [fill1,fill=fill1] (axis cs:-1,-1) rectangle (axis cs: 1,1);          
          \addplot [ultra thick,white]coordinates {(-1.,-1.)(1,1)};
        \end{axis}
        \node [right] at (myplot.right of origin) {\scriptsize $x$};
        \node [above] at (myplot.above origin) {\scriptsize $y$};
      \end{tikzpicture}
    \end{image}
    Note how we can draw an open disk around any point in the domain
    that lies entirely inside the domain, and also note how the only
    boundary points of the domain are the points on the line $y=x$. We
    conclude the domain is \wordChoice{\choice[correct]{an open
        set}\choice{a closed set}\choice{neither open nor closed
        set}}. Moreover, the set is \wordChoice{\choice{bounded}\choice[correct]{unbounded}}.
  \end{explanation}
\end{example}

\section{Limits}

On to the definition of a limit!
>>>>>>> upstream/master

\begin{theorem}
  Let $F:\R^n\to\R$ be a differentiable function and let
  \[
  \vec{x}(t) = \vector{x_1(t),x_2(t),\dots,x_n(t)}
  \]
  be a differentiable vector-valued function from $\R\to\R^n$. Then
  \[
  \dd[F]{t} = \grad F(\vec{x}(t)) \dotp \vec{x}'(t) 
  \]
\end{theorem}

It is good to understand what the situation of $F(x,y)$, $\vec{x}(t) =
\vector{x(t),y(t)}$ describes. We know that $F(x,y)$ describes a
surface; we also recognize that $\vec{x}(t)$ describes a curve in the
$(x,y)$-plane. Combining these together, we are describing a curve
that lies on the surface described by $F$. The parametric equations
for this curve are $x=x(t)$, $y=y(t)$ and $F\big(x(t),y(t)\big)$.
Consider
\begin{image}
  \begin{tikzpicture}
    \begin{axis}%
      [
        tick label style={font=\scriptsize},axis on top,
	axis lines=center,
	view={145}{35},
	name=myplot,
	%xtick={1,2,3,4},
	%ytick={1,2,3,4,5,6},
	%ztick=\empty,
	%extra x ticks={1},
	minor x tick num=1,
	minor y tick num=1,
	minor z tick num=1,
	%extra x tick labels={$a$},
	%extra y ticks={1},
	%extra y tick labels={$a$},
	%extra z ticks={1},
	%extra z tick labels={$h$},
	ymin=-.5,ymax=4.9,
	xmin=-.5,xmax=4.9,
	zmin=-.5, zmax=2.9,
	every axis x label/.style={at={(axis cs:\pgfkeysvalueof{/pgfplots/xmax},0,0)},xshift=-1pt,yshift=-4pt},
	xlabel={\scriptsize $x$},
	every axis y label/.style={at={(axis cs:0,\pgfkeysvalueof{/pgfplots/ymax},0)},xshift=5pt,yshift=-3pt},
	ylabel={\scriptsize $y$},
	every axis z label/.style={at={(axis cs:0,0,\pgfkeysvalueof{/pgfplots/zmax})},xshift=0pt,yshift=4pt},
	zlabel={\scriptsize $z$},
        colormap/cool
      ]
      \addplot3[domain=0:360,,y domain=0:4,
        samples=30,smooth,,samples y=0,dashed,very thick,penColor] ({cos(x)+2},{sin(x)+2},{0});
      
      \addplot3[domain=0:4,,y domain=0:4,mesh,samples=15,samples y=15,very thin,z buffer=sort] {-.2*(x-1)^2-.05*y^2+2};
      
      \addplot3[domain=0:360,,y domain=0:4,
        samples=30,smooth,,samples y=0,very thick,penColor] ({cos(x)+2},{sin(x)+2},{-.2*(cos(x)+2-1)^2-.05*(sin(x)+2)^2+2});
    \end{axis}
  \end{tikzpicture}
\end{image}
Here a surface is drawn, along with a dashed curve in the
$(x,y)$-plane. Restricting $F$ to just the points on this circle gives
the curve shown on the surface. The derivative $\dd[F]{t}$ gives the
instantaneous rate of change of $F$ with respect to $t$.

Now try your hand at the chain rule. 
\begin{question}
  Let $F(x,y)=x^2y+x$, where $x(t)=\sin(t)$ and $y(t)=e^{5t}$. Compute $\dd[F]{t}$.
  \begin{prompt}
  \[
  \dd[F]{t} = \answer{(2\sin(t)e^{5t}+1)\cos(t)+5e^{5t}\sin^2(t)}.
  \]
  \end{prompt}
\end{question}

The previous example can make us wonder: if we substituted for $x$ and
$y$ at the end to show that $\dd[F]{t}$ is really just a function of
$t$, why not substitute \textit{before} differentiating, showing
clearly that $F$ is a function of $t$?

That is, $z = x^2y+x = (\sin t)^2e^{5t}+\sin t.$ Applying the chain
and product rules, we have
\[
\dd[F]{t} = 2\sin(t)\cos(t) e^{5t}+ 5\sin^2(t) e^{5t}+\cos(t),
\]
which matches the result from the example.

This may now make one wonder ``What's the point? If we could already
find the derivative, why learn another way of finding it?'' In some
cases, applying this rule makes differentiation simpler, but this is
hardly the power of the chain rule. Rather, the chain rule is
extremely powerful when \textit{we do not know what $F$, $x$ and/or
  $y$ are}. It may be hard to believe, but often in ``the real world''
we know rate-of-change information (information about derivatives)
without explicitly knowing the underlying functions. The chain rule
allows us to combine several rates of change to find another rate of
change. The chain rule also as theoretic use, giving us insight into
the behavior of certain constructions. In particular, the chain rule
gives us a new explanation as to why the gradient is perpendicular to
level curves and surfaces.

\begin{example}
  Suppose that a vector-valued function
  $\vec{c}(t)=\vector{x(t),y(t)}$ runs along a level surface for the
  surface $F(x,y)$. Explain how the chain rule shows that the gradient
  points perpendicular to level curves and surfaces.
  \begin{explanation}
    We should ask ourselves: ``What is the change in $F$ as $t$
    varies?''  Since $\vec{c}(t)$ traces out a level curve, the change
    must be $\answer[given]{0}$. Comparing this to the chain rule we see:
    \begin{align*}
    \dd[F]{t} &= \grad F(\vec{c}(t)) \dotp \vec{c}'(t) \\
    &= \answer[given]{0}
    \end{align*}
    this tells us that the gradient is orthogonal to the tangent
    vectors of our level curve. This means that the gradient is
    orthogonal to level curves.
  \end{explanation}
\end{example}

Note that the last explanation works in any dimension. The up-shot?
\begin{quote}
  \textbf{Gradient vectors are orthogonal to level sets.}
\end{quote}
And while we've be saying this all along, it is the chain rule that
finally gives us a clean and precise explanation.


\section{New solutions for old problems}

We can also use our new chain rule to revisit problems from our
previous studies of calculus. Our new tools allow for simpler
solutions to these problems.

\subsection{Differentiating integrals}

Recall the following form of the Fundamental Theorem of Calculus:
\[
\ddx \int_a^x f(t) \d t = f(x) 
\]
\begin{question}
  Compute
  \[
  \dd x \int_0^x \frac{\sin(t)}{t} \d t
  \begin{prompt}
    = \answer{\frac{\sin(x)}{x}}
  \end{prompt}
  \]
\end{question}
It is easy to use the Fundamental Theorem of Calculus to differentiate
integrals, when the limits of integration are a constant and a
variable. However, when the limits are functions, things get more
complicated. The multivariable chain rule helps out in these
situations.
\begin{example}
  Compute:
  \[
  \dd{t} \int_{\sin(t)}^{\cos(t)} e^{(s^2)} \d s
  \]
  \begin{explanation}
    Let
    \begin{align*}
      F(x,y) &= \int_y^x e^{(s^2)} \d s\\
      x(t) &= \cos(t)\\
      y(t) &= \sin(t).
    \end{align*}
    Now,
    \[
    \dd{t} F(t) = \grad F(x(t),y(t)) \dotp \vector{\answer[given]{-\sin(t)},\answer[given]{\cos(t)}}.
    \]
    To compute the partials, we use the Fundamental Theorem of Calculus:
    \begin{align*}
    \pp[F]{x} &= \pp{x} \int_y^x e^{(s^2)} \d s\\
    &= \answer[given]{e^{(x^2)}}
    \end{align*}
    And
    \begin{align*}
      \pp[F]{y} &= \pp{y} \int_y^x e^{(s^2)} \d s\\
      \pp[F]{y} &= \pp{y} \left(-\int_x^y e^{(s^2)} \d s\right)\\
      &= \answer[given]{-e^{(y^2)}}
    \end{align*}
    So
    \begin{align*}
      \dd{t} F(t) &= \vector{e^{\cos^2(t)},-e^{\sin^2(t)}}\dotp \vector{-\sin(t),\cos(t)}\\
      &= \answer[given]{-e^{\cos^2(t)}\sin(t)-e^{\sin^2(t)}\cos(t)}.
    \end{align*}
  \end{explanation}
\end{example}


\begin{question}
  Compute:
  \[
  \dd{t} \int_{t^2}^{t^3} \frac{\sin(s)}{s} \d s
  \begin{prompt}
    = \answer{\frac{-2 t \sin(t^2)}{t^2}+\frac{3t^2\sin(t^3)}{t^3}}
  \end{prompt}
  \]
\end{question}




\subsection{Implicit differentiation}

We've used implicit differentiation to compute $\dd[y]{x}$ when $y$ is
given as an implicit function of $x$. Now we'll revisit this with the
chain rule and give a new, simpler, method of finding $\dd[y]{x}$.

For instance, consider the implicit function $x^2y-xy^3=3$. We learned
to use the following steps to find $\dd[y]{x}$:
\begin{align*}
\ddx\Big(x^2y-xy^3\big) &= \ddx\Big(3\Big) \\
2xy + x^2\dd[y]{x}-y^3-3xy^2\dd[y]{x} &= 0\\
\dd[y]{x} = -\frac{2xy-y^3}{x^2-3xy^2}.
\end{align*}
     
Instead of using this method, consider $z=x^2y-xy^3$. The implicit
function above describes the level curve $z=3$. Considering $x$ and
$y$ as functions of $x$, the chain rule states that
\[
\dd[z]{x} = \pp[z]{x}\dd[x]{x}+\pp[z]{y}\dd[y]{x}.
\]
Since $z$ is constant (in our example, $z=3$), $\dd[z]{x} = 0$. We
also know $\dd[x]{x} = 1$. Write with me,
\begin{align*}
  0 &= \pp[z]{x}(1) + \pp[z]{y}\dd[y]{x} \\
  \dd[y]{x} &= -\pp[z]{x}\Big/\pp[z]{y}\\
  &= -\frac{F^{(1,0)}(x,y)}{F^{(0,1)}(x,y)}.
\end{align*}

Note how our solution for $\dd[y]{x}$ above is just the partial
derivative of $z$, with respect to $x$, divided by the partial
derivative of $z$ with respect to $y$.  We state the above as a
theorem.

\begin{theorem}
  Let $F:\R^2\to\R$ be a differentiable function of $x$ and $y$, where
  $F(x,y)=c$ defines $y$ as an implicit function of $x$, for some
  constant $c$. Then \index{derivative!implicit}\index{implicit
    differentiation}
  \[
  \dd[y]{x} = -\frac{F^{(1,0)}(x,y)}{F^{(0,1)}(x,y)}.
  \]
<<<<<<< HEAD
\end{theorem}
=======
  does not exist by finding the limits along the lines $y=mx$.
  \begin{explanation}
    Evaluating $\lim_{\vector{x,y}\to\vector{0,0}} \frac{3xy}{x^2+y^2}$ along
    the lines $y=mx$ means replace all $y$'s with $mx$ and evaluating
    the resulting limit:
    \begin{align*}
      \lim_{\vector{x,mx}\to\vector{0,0}} \frac{3x(\answer[given]{m x})}{x^2+(\answer[given]{mx})^2} &=\lim_{x\to0} \frac{3mx^2}{x^2(m^2+1)}\\
      &= \lim_{x\to 0}\frac{3m}{m^2+1}\\
      &= \answer[given]{\frac{3m}{m^2+1}}.
    \end{align*}
    While the limit exists for each choice of $m$, we get a
    \textit{different} limit for each choice of $m$. Suppose $m=0$,
    then:
    \[
    \lim_{x\to 0}\frac{3m}{m^2+1} = \answer[given]{0}
    \]
    Now suppose that $m=1$, then:
    \[
    \lim_{x\to 0}\frac{3m}{m^2+1} = \answer[given]{3/2}
    \]
    Since we find differing limiting values when computing the limit
    along different paths, we must conclude that the limit does not
    exist.
    \begin{onlineOnly}
      We finish by presenting you with a plot of $F$:
      \begin{center}
        \geogebra{e2pAxbeP}{800}{600} %https://ggbm.at/e2pAxbeP
      \end{center}
    \end{onlineOnly}
  \end{explanation}
\end{example}
>>>>>>> upstream/master

Try your hand at this.

\begin{question}
  Given the implicitly defined function $\sin(x^2y^2)+y^3=x+y$, find
  $y'$.
  \begin{hint}
    Consider $F(x,y) = \sin(x^2y^2)+y^3-x-y$, and find
    $F^{(1,0)}(x,y)$, and $F^{(0,1)}(x,y)$.
  \end{hint}
  \begin{prompt}
  \[
  \dd[y]{x} = \answer{\frac{-2xy^2\cos(x^2y^2)+1}{2x^2y\cos(x^2y^2)+3y^2-1}}
  \]
<<<<<<< HEAD
  \end{prompt}
\end{question}
=======
  does not exist by finding the limit along the path $y=-\sin(x)$.
  \begin{explanation}
    Let
    \[
    F(x,y) = \frac{\sin(xy)}{x+y}.
    \]
    We will show that
    \[
    \lim_{\vector{x,y}\to\vector{0,0}} F(x,y)
    \]
    does not exist by finding the limit along the path
    $y=-\sin(x)$. First, however, let's try the same trick that worked
    before and see what happens. Consider the limits found along the
    lines $y=mx$ as done above.
    \begin{align*}
      \lim_{\vector{x,mx}\to\vector{0,0}} \frac{\sin\big(x(\answer[given]{mx})\big)}{x+\answer[given]{mx}} &= \lim_{x\to 0} \frac{\sin (mx^2)}{x(m+1)} \\
      &= \lim_{x\to 0} \frac{\sin(mx^2)}{x}\cdot\answer[given]{\frac{1}{m+1}}.
    \end{align*}
    By applying L'H\^opital's Rule, we can show this limit is $0$
    \emph{except} when $m=-1$, that is, along the line $y=-x$. This
    line is not in the domain of $F$, so we have found the following
    fact: along every line $y=mx$ in the domain of $F$,
    \[
    \lim_{\vector{x,y}\to\vector{0,0}} F(x,y)=0.
    \]
    Now consider the limit along the path $y=-\sin(x)$:
    \begin{align*}
      \lim_{\vector{x,-\sin(x)}\to\vector{0,0}} \frac{\sin\big(-x\sin(x)\big)}{x-\sin(x)} &= \lim_{x\to0} \frac{\sin\big(-x\sin(x)\big)}{x-\sin(x)}
    \end{align*}
    Now apply L'H\^opital's Rule twice to find a limit is of the form
    \numOverZero.  Hence the limit does not exist.  Step back and
    consider what we have just discovered.
    \begin{itemize}
    \item Along any line $y=mx$ in the domain of the $F(x,y)$, the
      limit is $0$.
    \item However, along the path $y=-\sin(x)$, which lies in the
      domain of the $F(x,y)$ for all $x\neq 0$, the limit does not
      exist.
    \end{itemize}
    Since the limit is not the same along every path to $(0,0)$, we say
    $\lim_{\vector{x,y}\to\vector{0,0}}\frac{\sin(xy)}{x+y}$ does not exist.
    \begin{onlineOnly}
      We finish by presenting you with a plot of $F$:
      \begin{center}
        \geogebra{vBrjrPkN}{800}{600} %https://ggbm.at/vBrjrPkN
      \end{center}
    \end{onlineOnly}
  \end{explanation}
\end{example}
>>>>>>> upstream/master

%\example{ex_implicit5}{Using Implicit Differentiation}{
%Given the implicitly defined function $\sin(x^2y^2)+y^3=x+y$, find $y'$.}
%$$y' = \frac{1 - 2xy^2\cos(x^2y^2)}{2x^2y\cos(x^2y^2)+3y^2-1}.$$


\end{document}
